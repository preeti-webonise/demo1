<?php
function check_letter($word,$letters_guessed)
{
	global $guess_template;
	$len = strlen($word);
	$guess_template = str_repeat("_",$len);
	for ($i = 0; $i < $len; $i++)
	{
		$ch = $word[$i];
		if (stristr($letters_guessed, $ch))
		 {
	 		 $pos = $i;
	 		 $guess_template[$pos] = $ch;
		 }
	}
	return $guess_template;
}

function handleguess() 
{
	global $words;
	global $hanged;
	global $category;
	global $guess_tamplate;
  	$choose_word = $_POST["word"];
  	$word  = $words[$choose_word];
  	$wrong = $_POST["wrong"];
  	$letters_guessed = $_POST["lettersguessed"];
  	$guess = $_POST["letter"];
  	$letter =$guess[0];
  	if(!strstr($word, $letter)) 
	{
		$wrong++;
  	}	
  	$letters_guessed = $letters_guessed . $letter;
  	$guess_template = check_letter($word, $letters_guessed);
  	if (!stristr($guess_template, "_")) 
	{
		game_won($word);
  	} 
	else if ($wrong >= 5) 
	{
		game_lost($word);
  	}
	 else 
	{
		printpage($category,$hanged[$wrong], $guess_template, $choose_word, $letters_guessed);
  	}
}

function game_won($word)
{
	echo <<<END
	<!DOCTYPE html>
	<html>
  	<head>
	<title>Hangman game</title>
  	</head>
  	<body>
	<h1>You win!</h1>
	<p>Congratulations! You guessed that the word was <em>$word</em>.</p>
 	 </body>
	</html>
END;
}

function game_lost($word)
{
	echo <<<END
	<!DOCTYPE html>
        <html>
        <head>
        <title>Hangman game</title>
        </head>
        <body>
        <h1>You lose!</h1>
        <p>word you were trying to guess was <em>$word</em>.</p>
         </body>
        </html>
END;

}
?>
